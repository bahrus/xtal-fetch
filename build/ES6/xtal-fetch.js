(function(){function a(){if(!customElements.get('xtal-fetch')){class a extends Polymer.Element{constructor(){super(...arguments),this.fetchInProgress=!1,this.as='text',this._cachedResults={},this.__loadNewUrlDebouncer=this.debounce(()=>{this.loadNewUrl()},0)}get cachedResults(){return this._cachedResults}static get is(){return'xtal-fetch'}static get properties(){return{as:{type:String},cacheResults:{type:Boolean},debounceDuration:{type:Number,observer:'debounceDurationHandler'},errorResponse:{type:Object,notify:!0,readOnly:!0},errorText:{type:Object,notify:!0,readOnly:!0},fetch:{type:Boolean,observer:'__loadNewUrlDebouncer'},fetchInProgress:{type:Boolean,notify:!0,readOnly:!0,reflectToAttribute:!0},forEach:{type:String},href:{type:String,observer:'__loadNewUrlDebouncer',reflectToAttribute:!0},inEntities:{type:Array,observer:'__loadNewUrlDebouncer'},insertResults:{type:Boolean},reqInit:{type:Object},reqInitRequired:{type:Boolean},result:{type:Object,notify:!0,readOnly:!0},setPath:{type:String,value:'result',reflectToAttribute:!0}}}debounce(a,b,c){var d;return function(){var e=this,f=arguments;clearTimeout(d),d=setTimeout(function(){d=null,c||a.apply(e,f)},b),c&&!d&&a.apply(e,f)}}debounceDurationHandler(){this.__loadNewUrlDebouncer=this.debounce(()=>{this.loadNewUrl()},this.debounceDuration)}loadNewUrl(){if(this.fetch&&(!this.reqInitRequired||this.reqInit)&&(this._setErrorText(null),this._setErrorResponse(null),this.href)){const a=this;let b=0;if(this.forEach){if(!this.inEntities)return;const c=this.forEach.split(',');let d=this.inEntities.length;this._setFetchInProgress(!0),this.inEntities.forEach((e)=>{e.__xtal_idx=b,b++;let f=this.href;if(c.forEach((a)=>{f=f.replace(':'+a,e[a])}),this.cacheResults){const a=this.cachedResults[f];if(a)return e[this.setPath]=a,d--,void(0===d&&this._setFetchInProgress(!1))}fetch(f,this.reqInit).then((b)=>{200===b.status?b[a.as]().then((a)=>{d--,0===d&&this._setFetchInProgress(!1),this.cacheResults&&(this.cachedResults[f]=a),e[this.setPath]=a;const b={entity:e,href:f};this.dispatchEvent(new CustomEvent('fetch-complete',{detail:b,bubbles:!0,composed:!1}))}):b.text().then((a)=>{this._setErrorText(a)})})})}else{if(this.cacheResults){const b=this.cachedResults[this.href];if(b)return void a._setResult(b)}this._setFetchInProgress(!0);const b=this.href;fetch(b,this.reqInit).then((c)=>{this._setFetchInProgress(!1),this._setErrorResponse(c),200===c.status?c[a.as]().then((c)=>{this.cachedResults&&(this.cachedResults[this.href]=c),a._setResult(c),'string'===typeof c&&this.insertResults&&(this.innerHTML=c);this.dispatchEvent(new CustomEvent('fetch-complete',{detail:{href:b},bubbles:!0,composed:!1}))}):c.text().then((a)=>{this._setErrorText(a)})}).catch((a)=>{this._setErrorResponse(a),this._setFetchInProgress(!1)})}}}}customElements.define(a.is,a)}}function b(){return'function'!==typeof Polymer||'function'!==typeof Polymer.Element?void setTimeout(b,100):void a()}b()})();