(function(){function a(){if(!customElements.get('xtal-fetch')){class a extends Polymer.Element{constructor(){super(...arguments),this.fetchInProgress=!1,this.as='text',this._cachedResults={},this.__loadNewUrlDebouncer=this.debounce(()=>{this.loadNewUrl()},0)}get cachedResults(){return this._cachedResults}static get is(){return'xtal-fetch'}static get properties(){return{as:{type:String},baseLinkId:{type:String},cacheResults:{type:Boolean},debounceDuration:{type:Number,observer:'debounceDurationHandler'},errorResponse:{type:Object,notify:!0,readOnly:!0},errorText:{type:Object,notify:!0,readOnly:!0},fetch:{type:Boolean,observer:'__loadNewUrlDebouncer'},fetchInProgress:{type:Boolean,notify:!0,readOnly:!0,reflectToAttribute:!0},forEach:{type:String},href:{type:String,observer:'__loadNewUrlDebouncer',reflectToAttribute:!0},inEntities:{type:Array,observer:'__loadNewUrlDebouncer'},insertResults:{type:Boolean},reqInit:{type:Object},reqInitRequired:{type:Boolean},result:{type:Object,notify:!0,readOnly:!0},setPath:{type:String,value:'result',reflectToAttribute:!0}}}debounce(a,b,c){let d;return function(){const e=this,f=arguments;clearTimeout(d),d=setTimeout(function(){d=null,c||a.apply(e,f)},b),c&&!d&&a.apply(e,f)}}debounceDurationHandler(){this.__loadNewUrlDebouncer=this.debounce(()=>{this.loadNewUrl()},this.debounceDuration)}loadNewUrl(){if(!this.fetch)return;if(this.reqInitRequired&&!this.reqInit)return;this._setErrorText(null),this._setErrorResponse(null);const a=this.baseLinkId?self[this.baseLinkId].href:'';if(this.href){const b=this;let c=0;if(this.forEach){if(!this.inEntities)return;const d=this.forEach.split(',');let e=this.inEntities.length;this._setFetchInProgress(!0),this.inEntities.forEach((f)=>{f.__xtal_idx=c,c++;let g=a+this.href;if(d.forEach((a)=>{g=g.replace(':'+a,f[a])}),this.cacheResults){const a=this.cachedResults[g];if(a)return f[this.setPath]=a,e--,void(0===e&&this._setFetchInProgress(!1))}fetch(g,this.reqInit).then((a)=>{200===a.status?a[b.as]().then((a)=>{e--,0===e&&this._setFetchInProgress(!1),this.cacheResults&&(this.cachedResults[g]=a),f[this.setPath]=a;const b={entity:f,href:g};this.dispatchEvent(new CustomEvent('fetch-complete',{detail:b,bubbles:!0,composed:!1}))}):a.text().then((a)=>{this._setErrorText(a)})})})}else{if(this.cacheResults){const a=this.cachedResults[this.href];if(a)return void b._setResult(a)}this._setFetchInProgress(!0);const c=a+this.href;fetch(c,this.reqInit).then((a)=>{this._setFetchInProgress(!1),this._setErrorResponse(a),200===a.status?a[b.as]().then((a)=>{this.cachedResults&&(this.cachedResults[this.href]=a),b._setResult(a),'string'===typeof a&&this.insertResults&&(this.innerHTML=a,this.dispatchEvent(new CustomEvent('dom-change',{bubbles:!0,composed:!0})));this.dispatchEvent(new CustomEvent('fetch-complete',{detail:{href:c},bubbles:!0,composed:!1}))}):a.text().then((a)=>{this._setErrorText(a)})}).catch((a)=>{this._setErrorResponse(a),this._setFetchInProgress(!1)})}}}}customElements.define(a.is,a)}}function b(){return'function'!==typeof Polymer||'function'!==typeof Polymer.Element?void setTimeout(b,100):void a()}b()})();