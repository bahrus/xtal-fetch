(function(){function a(a){return a.replace(/(\-\w)/g,function(a){return a[1].toUpperCase()})}var b="href",c="disabled",d=function(a){function d(){var a;return babelHelpers.classCallCheck(this,d),a=babelHelpers.possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).apply(this,arguments)),a._reqInit={credentials:"include"},a._as="json",a}return babelHelpers.inherits(d,a),babelHelpers.createClass(d,[{key:"de",value:function de(a,b){var c=new CustomEvent(a+"-changed",{detail:b,bubbles:!0,composed:!1});return this.dispatchEvent(c),c}},{key:"_upgradeProperties",value:function _upgradeProperties(a){var b=this;a.forEach(function(a){if(b.hasOwnProperty(a)){var c=b[a];delete b[a],b[a]=c}})}},{key:"attributeChangedCallback",value:function attributeChangedCallback(a,b,d){this["_"+a]="fetch"===a||a===c?null!==d:d,this.onPropsChange()}},{key:"onPropsChange",value:function onPropsChange(){this.loadNewUrl()}},{key:"loadNewUrl",value:function loadNewUrl(){this.fetch&&this.href&&!this.disabled&&this.do()}},{key:"do",value:function _do(){var a=this;self.fetch(this.href,this._reqInit).then(function(b){b[a._as]().then(function(b){a.result=b})})}},{key:"connectedCallback",value:function connectedCallback(){this._upgradeProperties(["fetch",b,c])}},{key:"fetch",get:function get(){return this._fetch},set:function set(a){a?this.setAttribute("fetch",""):this.removeAttribute("fetch")}},{key:"disabled",get:function get(){return this.hasAttribute(c)},set:function set(a){a?this.setAttribute(c,""):this.removeAttribute(c)}},{key:"href",get:function get(){return this._href},set:function set(a){this.setAttribute(b,a)}},{key:"result",get:function get(){return this._result},set:function set(a){this._result=a,this.de("result",a)}}],[{key:"is",get:function get(){return"xtal-fetch-get"}},{key:"observedAttributes",get:function get(){return["fetch",b,c]}}]),d}(babelHelpers.wrapNativeSuper(HTMLElement));customElements.get(d.is)||customElements.define(d.is,d);var e="req-init-required",f="cache-results",g="insert-results",h="base-link-id",i=function(b){function c(){var a;return babelHelpers.classCallCheck(this,c),a=babelHelpers.possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).call(this)),a._cacheResults=!1,a._cachedResults={},a._fetchInProgress=!1,a._reqInit=null,a}return babelHelpers.inherits(c,b),babelHelpers.createClass(c,[{key:"onPropsChange",value:function onPropsChange(){this.reqInitRequired&&!this.reqInit||(!this.__loadNewUrlDebouncer&&this.debounceDurationHandler(),this.__loadNewUrlDebouncer())}},{key:"attributeChangedCallback",value:function attributeChangedCallback(b,d,i){"debounce-duration"===b?(this._debounceDuration=parseFloat(i),this.debounceDurationHandler()):b===e||b===f||b===g?this["_"+a(b)]=null!==i:b===h?this._baseLinkId=i:void 0,babelHelpers.get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"attributeChangedCallback",this).call(this,b,d,i)}},{key:"debounce",value:function debounce(a,b,c){var d;return function(){var e=this,f=arguments;clearTimeout(d),d=setTimeout(function(){d=null,c||a.apply(e,f)},b),c&&!d&&a.apply(e,f)}}},{key:"debounceDurationHandler",value:function debounceDurationHandler(){var a=this;this.__loadNewUrlDebouncer=this.debounce(function(){a.loadNewUrl()},this._debounceDuration)}},{key:"do",value:function _do(){var a=this;if(this.errorResponse=null,this._cacheResults){var c=this.cachedResults[this._href];if(c)return void(this.result=c)}this.fetchInProgress=!0;var b=this.href;if(this._baseLinkId){var d=self[this._baseLinkId];d&&(b=d.href+b)}self.fetch(this.href,this._reqInit).then(function(b){a.fetchInProgress=!1,b[a._as]().then(function(c){if(200!==b.status)a.errorResponse=b,b.text().then(function(b){a.errorText=b});else{a.result=c,a.cachedResults&&(a.cachedResults[a._href]=c),"string"===typeof c&&a._insertResults&&(a.innerHTML=c);var d={href:a.href};a.dispatchEvent(new CustomEvent("fetch-complete",{detail:d,bubbles:!0,composed:!1}))}})})}},{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"connectedCallback",this).call(this),this._upgradeProperties(["debounceDuration","reqInitRequired","cacheResults","reqInit"])}},{key:"reqInit",get:function get(){return this._reqInit},set:function set(a){this._reqInit=a,this.onPropsChange()}},{key:"cacheResults",get:function get(){return this._cacheResults},set:function set(a){a?this.setAttribute(f,""):this.removeAttribute(f)}},{key:"cachedResults",get:function get(){return this._cachedResults}},{key:"reqInitRequired",get:function get(){return this.hasAttribute(e)},set:function set(a){a?this.setAttribute(e,""):this.removeAttribute(e)}},{key:"debounceDuration",get:function get(){return this._debounceDuration},set:function set(a){this.setAttribute("debounce-duration",a.toString())}},{key:"errorResponse",get:function get(){return this._errorResponse},set:function set(a){this._errorResponse=a,this.de("error-response",{value:a})}},{key:"errorText",get:function get(){return this._errorText},set:function set(a){this._errorText=a,this.de("error-text",{value:a})}},{key:"fetchInProgress",get:function get(){return this._fetchInProgress},set:function set(a){this._fetchInProgress=a,this.de("fetch-in-progress",{value:a})}},{key:"insertResults",get:function get(){return this._insertResults},set:function set(a){a?this.setAttribute(g,""):this.removeAttribute(g)}},{key:"baseLinkId",get:function get(){return this._baseLinkId},set:function set(a){this.setAttribute(h,a)}}],[{key:"is",get:function get(){return"xtal-fetch-req"}},{key:"observedAttributes",get:function get(){return babelHelpers.get(c.__proto__||Object.getPrototypeOf(c),"observedAttributes",this).concat(["debounce-duration",e,f,g,h])}}]),c}(d);customElements.get(i.is)||customElements.define(i.is,i);var j="set-path",k=function(b){function c(){return babelHelpers.classCallCheck(this,c),babelHelpers.possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return babelHelpers.inherits(c,b),babelHelpers.createClass(c,[{key:"attributeChangedCallback",value:function attributeChangedCallback(b,d,e){b===j||"for-each"===b?this["_"+a(b)]=e:void 0,babelHelpers.get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"attributeChangedCallback",this).call(this,b,d,e)}},{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"connectedCallback",this).call(this),this._upgradeProperties(["forEach","setPath","inEntities"])}},{key:"onPropsChange",value:function onPropsChange(){var a=this.setPath||this.forEach||this.inEntities;a&&(this._hasAllThreeProps=this._setPath&&this._forEach&&this.inEntities,!this._hasAllThreeProps)||babelHelpers.get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"onPropsChange",this).call(this)}},{key:"do",value:function _do(){var a=this;if(!this._hasAllThreeProps)return void babelHelpers.get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"do",this).call(this);var b=this._forEach.split(","),d=this._inEntities.length;this.fetchInProgress=!0;for(var e,f=0,g=this._baseLinkId?self[this._baseLinkId].href:"",h=function(c){var e=a._inEntities[c];e.__xtal_idx=f,f++;var h=a._href;if(b.forEach(function(a){h=h.replace(":"+a,e[a])}),h=g+h,a._cacheResults){var i=a.cachedResults[h];if(i)return e[a._setPath]=i,d--,0===d&&(a.fetchInProgress=!1),{v:void 0}}self.fetch(h,a._reqInit).then(function(b){200===b.status?b[a._as]().then(function(b){d--,0===d&&(a.fetchInProgress=!1),a._cacheResults&&(a.cachedResults[h]=b),e[a._setPath]=b;var c={entity:e,href:h};a.dispatchEvent(new CustomEvent("fetch-complete",{detail:c,bubbles:!0,composed:!1}))}):(b.text().then(function(b){a.errorText=b}),a.errorResponse=b)})},j=0,i=this._inEntities.length;j<i;j++)if(e=h(j,i),"object"===babelHelpers.typeof(e))return e.v}},{key:"forEach",get:function get(){return this._forEach||this.getAttribute("for-each")},set:function set(a){this.setAttribute("for-each",a)}},{key:"setPath",get:function get(){return this._setPath||this.getAttribute(j)},set:function set(a){this.setAttribute(j,a)}},{key:"inEntities",get:function get(){return this._inEntities},set:function set(a){this._inEntities=a,this.onPropsChange()}}],[{key:"is",get:function get(){return"xtal-fetch-entities"}},{key:"observedAttributes",get:function get(){return babelHelpers.get(c.__proto__||Object.getPrototypeOf(c),"observedAttributes",this).concat(["for-each",j])}}]),c}(i);customElements.get(k.is)||customElements.define(k.is,k);var l=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,null,[{key:"is",get:function get(){return"xtal-fetch"}}]),b}(k);customElements.get(l.is)||customElements.define(l.is,l)})();